require(GeneFamilies)
options(mc.cores = detectCores())

message("USAGE: Rscript path/2/GeneFamilies/exec/loadGeneFamilies.R path/2/GeneFamilies/data mcl_output.txt")
message("EXPECTED INPUT FORMATS:")
message(" - mcl_output.txt is the textual output generated by the markob clustering tool mcl used on the all vs all sequence similarity search results. A single cluster (family) is expected per line and gene members to be separated by TAB.")

input.args <- commandArgs(trailingOnly = TRUE)

families.genes.df <- readMclOutput(input.args[[2]])
families.lst <- mclDataFrameAsList(families.genes.df)
families.df <- Reduce( rbind, lapply( unique(families.genes.df$Family), function(fam.name) {
                                       fam.genes <- families.genes.df[ which( families.genes.df$Family == fam.name ), "Gene" ]
} )

families.df <- read.table(input.args[[3]], sep = "\t", header = TRUE, stringsAsFactors = FALSE, 
    comment.char = "", quote = "", na.strings = "", colClasses = c("character", rep("numeric", 
        8)))
families.df$size <- apply(families.df[, 2:9], 1, sum)

#' Save parsed data:
save(families.genes.df, families.lst, families.df, file = file.path(input.args[[1]], 
    "families.RData"))
